<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>数字基带信号模拟</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/highcharts.js"></script>
</head>
<body>
<div class="container-fluid">
    <h1 align="center">简单传输码模拟</h1>
    <!--<hr style="border-top:1px solid red;"/>-->
    <div id="tab" style="width: 100%; height:600px;"></div>
    <br><br>
    <div align="center">
        <input id="in" type="text" class="form-control" placeholder="输入序列" style="width: 80%">
    </div>
    <div id="show"></div>
</div>
<script language="JavaScript">
    function coder(numble) {
        var tab = [
            [-17, -10, -3],
            [-37, -30, -23],
            [-57, -50, -43]
        ];
        switch (numble) {
            case 0:
                if (value === 1) {
                    return [tab[0][2], tab[0][2]];
                } else {
                    return [tab[0][1], tab[0][1]];
                }
        }
    }
    $(document).ready(function () {
        var tab = [[-17, -10, -3],
            [-37, -30, -23],
            [-57, -50, -43]
        ];
        var flag = 0;
        var value = 0;
        var count = 0;
        var chart = {
            type: 'line',
            margin: 0,
            events: {
                load: function () {
                    var s = this.series;

                    setInterval(function () {
                        if (flag === 1) {
                            for(var i = 0; i < 3; i++){
                                var data = coder(i);
                                for(var j = 0; j < data.length; j++){
                                    series.addPoint([count*10+390, data[j]],true,true);
                                    count = count + 1;
                                }
                            }
                            flag = 0;
                        }
                    }, 200);
                }
            }
        };
        var title = {
            text: ''
        };
        var xAxis = {
            tickPixelInterval: 100
        };
        var yAxis = {
            title: {
                text: ''
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        };
        var plotOptions = {};
        var series = [
            {
                name: "单极性不归零（NRZ）码",
                data: (function () {
                    var data = [], i;
                    for (i = 0; i < 40; i++) {
                        data.push({
                            x: i * 10,
                            y: -10
                        })
                    }
                    return data;
                }())
            },
            {
                name: "双极性不归零（NRZ）码",
                data: (function () {
                    var data = [], i;
                    for (i = 0; i < 40; i++) {
                        data.push({
                            x: i * 10,
                            y: -30
                        })
                    }
                    return data;
                }())
            },
            {
                name: "单极性归零码（RZ） ",
                data: (function () {
                    var data = [], i;
                    for (i = 0; i < 40; i++) {
                        data.push({
                            x: i * 10,
                            y: -50
                        })
                    }
                    return data;
                }())
            }
        ];
        var tooltip = {
            enabled: true
        };

        var json = {};
        json.chart = chart;
        json.title = title;
        json.xAxis = xAxis;
        json.yAxis = yAxis;
        json.series = series;
        json.tooltip = tooltip;
        json.plotOptions = plotOptions;
        // json.credits.enabled=false;
        $('#tab').highcharts(json);
        var input = document.getElementById("in");
        input.oninput = function () {
            var context = $('#in').val();
            var tmp = context.charAt(context.length - 1);
            if (tmp === '0') {
                value = 0;
            }
            if (tmp === '1') {
                value = 1;
            }
            count = context.length - 1;
            flag = 1;
            // json.chart.series[0].addPoint([(4*count - 1) * 10 + 390, tab[0][1]], true, true);
        }
    });
</script>
</body>
</html>